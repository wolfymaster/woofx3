version: v2
plugins:
  # Generate the Go Twirp server code (HTTP-based RPC, not GRPC)
  - local: protoc-gen-twirp
    out: gen/go
    opt:
      - paths=source_relative

  # Generate Go protobuf types
  - remote: buf.build/protocolbuffers/go
    out: gen/go
    opt:
      - paths=source_relative

  # Generate Rust protobuf types
  - remote: buf.build/community/neoeinstein-prost:v0.2.3
    out: gen/rust

  # Add Serde support to Rust types
  - remote: buf.build/community/neoeinstein-prost-serde:v0.2.3
    out: gen/rust

inputs:
  - directory: api